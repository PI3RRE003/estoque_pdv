<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "ORDEM SUPLEMENTOS" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= favicon_link_tag 'ORDEM_SUPLEMENTOS.png' %>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/js/tom-select.complete.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartkick@5.0.1/dist/chartkick.min.js"></script>
    
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <%= yield :head %>

    <style>
      body { min-height: 100vh; display: flex; flex-direction: column; }
      main { flex-grow: 1; }
      .button_to { display: inline; }
    </style>
  </head>

  <body class="bg-zinc-950 text-zinc-100 font-sans">
    
    <% if user_signed_in? %>
      <nav class="border-b border-zinc-800 bg-zinc-900 sticky top-0 z-50 shadow-2xl">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
          
          <div class="flex items-center gap-4">
  <%# Container da imagem maior: w-14 h-14 %>
  <div class="w-14 h-14 bg-zinc-900 rounded-xl flex items-center justify-center shadow-[0_0_20px_rgba(234,88,12,0.2)] overflow-hidden border border-zinc-800">
    <%= image_tag 'ORDEM_SUPLEMENTOS.png', class: "w-full h-full object-contain p-1" %>
  </div>
  
  <div class="flex flex-col">
    <span class="text-white font-black text-2xl tracking-tighter uppercase italic leading-none">
      ORDEM<span class="text-orange-500"> SUPLEMENTOS</span>
    </span>
    <p class="text-[8px] text-zinc-500 font-bold tracking-[0.3em] uppercase">Nutrition & Performance</p>
  </div>
</div>
          <div class="hidden lg:flex items-center gap-2">
            <%= link_to "DASHBOARD", root_path, class: "px-4 py-2 rounded-xl text-xs font-bold transition-all #{current_page?(root_path) ? 'bg-orange-600 text-white shadow-lg' : 'text-zinc-400 hover:text-white hover:bg-zinc-800'}" %>
            <%= link_to "NOVA VENDA", new_sale_path, class: "px-4 py-2 rounded-xl text-xs font-bold transition-all #{current_page?(new_sale_path) ? 'bg-orange-600 text-white shadow-lg' : 'text-zinc-400 hover:text-white hover:bg-zinc-800'}" %>
            <%= link_to "HISTÓRICO", sales_path, class: "px-4 py-2 rounded-xl text-xs font-bold transition-all #{current_page?(sales_path) ? 'bg-orange-600 text-white shadow-lg' : 'text-zinc-400 hover:text-white hover:bg-zinc-800'}" %>
            <%= link_to "ESTOQUE", products_path, class: "px-4 py-2 rounded-xl text-xs font-bold transition-all #{current_page?(products_path) ? 'bg-orange-600 text-white shadow-lg' : 'text-zinc-400 hover:text-white hover:bg-zinc-800'}" %>
            <%= link_to "CLIENTES", clients_path, class: "px-4 py-2 rounded-xl text-xs font-bold transition-all #{current_page?(clients_path) ? 'bg-orange-600 text-white shadow-lg' : 'text-zinc-400 hover:text-white hover:bg-zinc-800'}" %>
          </div>

          <div class="flex items-center gap-4">
            <% if current_user.admin? %>
              <%# MUDANÇA AQUI: Aponta para users_path (nossa gestão) em vez de registration_path %>
              <%= link_to users_path, class: "flex items-center gap-2 text-orange-500 hover:bg-orange-500/10 transition-all text-[10px] font-black uppercase tracking-widest border border-orange-500/20 px-4 py-2 rounded-xl" do %>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                Equipe
              <% end %>
            <% end %>

            <div class="flex items-center gap-3 pl-4 border-l border-zinc-800">
              <div class="text-right hidden sm:block">
                <p class="text-white text-[10px] font-black uppercase leading-none"><%= current_user.name %></p>
                <p class="text-orange-500 text-[8px] font-bold uppercase tracking-widest italic"><%= current_user.role %></p>
              </div>
              <%= button_to destroy_user_session_path, method: :delete, class: "p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500 hover:text-white transition-all border border-red-500/20" do %>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                </svg>
              <% end %>
            </div>
          </div>
        </div>
      </nav>
    <% end %>

    <% if notice || alert %>
      <div class="container mx-auto px-6 mt-4">
        <% if notice %>
          <div class="bg-green-500/10 border border-green-500/20 text-green-500 px-4 py-3 rounded-xl text-sm font-medium">
            <%= notice %>
          </div>
        <% end %>
        <% if alert %>
          <div class="bg-red-500/10 border border-red-500/20 text-red-500 px-4 py-3 rounded-xl text-sm font-medium">
            <%= alert %>
          </div>
        <% end %>
      </div>
    <% end %>

    <main class="container mx-auto mt-8 px-6 pb-12">
      <%= yield %>
    </main>

    <footer class="border-t border-zinc-900 p-6 text-center">
      <p class="text-zinc-700 text-[10px] uppercase tracking-[0.3em]">Sistema de Gestão 2026 • v1.0</p>
    </footer>
  </body>
</html>